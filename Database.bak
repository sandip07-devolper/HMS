=========================
üè¢ Tenants (VERY IMPORTANT)
=========================
CREATE TABLE Tenants (
    TenantID INT PRIMARY KEY IDENTITY(1,1),
    TenantName NVARCHAR(150) NOT NULL,
    Domain NVARCHAR(100) NULL, -- subdomain or custom domain
    IsActive BIT DEFAULT 1,
    CreatedDate DATETIME DEFAULT GETDATE()
);

=========================
üë• Users & Roles
=========================
CREATE TABLE Roles (
    RoleID INT PRIMARY KEY,
    RoleName NVARCHAR(50) NOT NULL
);

CREATE TABLE Users (
    UserID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    Username NVARCHAR(100) NOT NULL,
    PasswordHash NVARCHAR(200) NOT NULL,
    RoleID INT NOT NULL,
    Email NVARCHAR(100),
    IsActive BIT DEFAULT 1,
    CreatedDate DATETIME DEFAULT GETDATE(),
    UNIQUE (TenantID, Username),
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID),
    FOREIGN KEY (RoleID) REFERENCES Roles(RoleID)
);

=========================
üåç Geography (Shared / Master)
=========================

(No TenantID ‚Äì common data)

CREATE TABLE Province (
    ProvinceID INT PRIMARY KEY IDENTITY(1,1),
    ProvinceName NVARCHAR(100) NOT NULL
);

CREATE TABLE District (
    DistrictID INT PRIMARY KEY IDENTITY(1,1),
    DistrictName NVARCHAR(100) NOT NULL,
    ProvinceID INT,
    DistrictName_Nep NVARCHAR(100),
    FOREIGN KEY (ProvinceID) REFERENCES Province(ProvinceID)
);

=========================
üîó Sources & Shifts
=========================
CREATE TABLE Source (
    SourceID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    SourceName NVARCHAR(100) NOT NULL,
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID)
);

CREATE TABLE Shift (
    ShiftID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    ShiftName NVARCHAR(50) NOT NULL,
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID)
);

=========================
üéì Students
=========================
CREATE TABLE StudentMain (
    StudentID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    FullName NVARCHAR(100) NOT NULL,
    FirstName NVARCHAR(50),
    MiddleName NVARCHAR(50),
    LastName NVARCHAR(50),
    Gender VARCHAR(10),
    DateOfBirth DATE,
    PhoneNumber VARCHAR(15),
    Email NVARCHAR(100),
    Address NVARCHAR(200),
    SourceID INT,
    ShiftID INT,
    ImagePath NVARCHAR(255),
    CreatedDate DATETIME DEFAULT GETDATE(),
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID),
    FOREIGN KEY (SourceID) REFERENCES Source(SourceID),
    FOREIGN KEY (ShiftID) REFERENCES Shift(ShiftID)
);

=========================
üîÅ Referrals & Follow-ups
=========================
CREATE TABLE Referrals (
    ReferralID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    StudentID INT NOT NULL,
    ReferredByUserID INT NOT NULL,
    ReferralSourceID INT NULL,
    ReferralDate DATETIME DEFAULT GETDATE(),
    Status VARCHAR(20) DEFAULT 'Pending',
    Remarks NVARCHAR(255),
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID),
    FOREIGN KEY (StudentID) REFERENCES StudentMain(StudentID),
    FOREIGN KEY (ReferredByUserID) REFERENCES Users(UserID),
    FOREIGN KEY (ReferralSourceID) REFERENCES Source(SourceID)
);

CREATE TABLE StudentFollowUps (
    FollowUpID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    ReferralID INT NOT NULL,
    FollowUpDate DATETIME DEFAULT GETDATE(),
    FollowUpType VARCHAR(50),
    FollowUpRemarks NVARCHAR(255),
    FollowedByUserID INT,
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID),
    FOREIGN KEY (ReferralID) REFERENCES Referrals(ReferralID),
    FOREIGN KEY (FollowedByUserID) REFERENCES Users(UserID)
);

=========================
üßë‚Äçüè´ Staff
=========================
CREATE TABLE Staff (
    StaffID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    FullName NVARCHAR(100),
    Gender VARCHAR(10),
    Email NVARCHAR(100),
    PhoneNumber VARCHAR(15),
    HireDate DATE,
    RoleID INT,
    UserID INT,
    Religion VARCHAR(30),
    PermanentProvinceID INT,
    PermanentDistrictID INT,
    TemporaryProvinceID INT,
    TemporaryDistrictID INT,
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID),
    FOREIGN KEY (RoleID) REFERENCES Roles(RoleID),
    FOREIGN KEY (UserID) REFERENCES Users(UserID),
    FOREIGN KEY (PermanentProvinceID) REFERENCES Province(ProvinceID),
    FOREIGN KEY (PermanentDistrictID) REFERENCES District(DistrictID),
    FOREIGN KEY (TemporaryProvinceID) REFERENCES Province(ProvinceID),
    FOREIGN KEY (TemporaryDistrictID) REFERENCES District(DistrictID)
);

=========================
üìö Courses & Enrollment
=========================
CREATE TABLE Courses (
    CourseID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    CourseName NVARCHAR(100),
    Fee DECIMAL(10,2),
    Status VARCHAR(20),
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID)
);

CREATE TABLE Enrollments (
    EnrollmentID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    StudentID INT,
    CourseID INT,
    EnrollmentDate DATE,
    Status VARCHAR(20),
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID),
    FOREIGN KEY (StudentID) REFERENCES StudentMain(StudentID),
    FOREIGN KEY (CourseID) REFERENCES Courses(CourseID)
);

=========================
üí∞ Billing
=========================
CREATE TABLE Billing (
    BillID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    EnrollmentID INT,
    Amount DECIMAL(10,2),
    PaidAmount DECIMAL(10,2),
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID),
    FOREIGN KEY (EnrollmentID) REFERENCES Enrollments(EnrollmentID)
);

=========================
üìÅ Documents
=========================
CREATE TABLE StudentDocuments (
    DocumentID INT PRIMARY KEY IDENTITY(1,1),
    TenantID INT NOT NULL,
    StudentID INT,
    FileName NVARCHAR(255),
    FilePath NVARCHAR(500),
    UploadedByUserID INT,
    FOREIGN KEY (TenantID) REFERENCES Tenants(TenantID),
    FOREIGN KEY (StudentID) REFERENCES StudentMain(StudentID),
    FOREIGN KEY (UploadedByUserID) REFERENCES Users(UserID)
);
